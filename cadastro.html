<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro para Adoção - AEA</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="cabecalho">
        <a href="inicio.html"><img src="imagens/logo-extensa.png" alt="Logo" class="logo-cabecalho"></a>
        <div class="mobile-menu-icon" id="menu-toggle">
            <span class="bar"></span><span class="bar"></span><span class="bar"></span>
        </div>
        <nav class="nav-cabecalho" id="nav-list">
            <a href="inicio.html">Início</a>
            <a href="Sobrenos.html">Sobre Nós</a>
            <a href="adote.html">Adote</a>
            <a href="nos-apoie.html">Nos Apoie</a>
            <a href="faleconosco.html">Fale Conosco</a>
        </nav>
    </header>

    <div class="main-cadastro-container">
        <div class="form-card">
            <div class="form-header">
                <h1><i class="fas fa-heart"></i> Formulário de Adoção</h1>
                <p>Preencha os dados com carinho para conhecermos você.</p>
            </div>

            <form id="form-adocao">
                <!-- Seção 1 -->
                <h3 class="section-title"><i class="fas fa-paw"></i> Interesse</h3>
                <div class="form-group">
                    <label>Animal Desejado</label>
                    <!-- Readonly para o usuário não editar manualmente -->
                    <input type="text" id="animal_desejado" name="animal_desejado" readonly class="input-readonly" placeholder="Selecione na página 'Adote'">
                </div>

                <!-- Seção 2: Grid de 2 colunas no Desktop -->
                <h3 class="section-title"><i class="fas fa-user"></i> Seus Dados</h3>
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label>Nome Completo</label>
                        <input type="text" name="nome" required placeholder="Digite seu nome completo">
                    </div>

                    <div class="form-group">
                        <label>Data de Nascimento</label>
                        <input type="date" name="nascimento" required>
                    </div>

                    <div class="form-group">
                        <label>Instagram</label>
                        <input type="text" name="instagram" required placeholder="@seu.perfil">
                    </div>

                    <div class="form-group">
                        <label>E-mail</label>
                        <input type="email" name="email" required placeholder="exemplo@email.com">
                    </div>

                    <div class="form-group">
                        <label>Telefone / WhatsApp</label>
                        <input type="tel" name="telefone" required placeholder="(XX) 9XXXX-XXXX">
                    </div>
                </div>

                <!-- Seção 3 -->
                <h3 class="section-title"><i class="fas fa-home"></i> Moradia</h3>
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label>Endereço Completo</label>
                        <input type="text" name="endereco" required placeholder="Rua, Número, Bairro, Cidade">
                    </div>

                    <div class="form-group">
                        <label>Tipo de Residência</label>
                        <select name="tipo_moradia" required>
                            <option value="" disabled selected>Selecione...</option>
                            <option value="Casa">Casa com quintal</option>
                            <option value="Casa sem quintal">Casa sem quintal</option>
                            <option value="Apartamento">Apartamento</option>
                            <option value="Sítio">Sítio / Chácara</option>
                        </select>
                    </div>
                </div>

                <!-- Seção 4 -->
                <h3 class="section-title"><i class="fas fa-comment-dots"></i> Perguntas</h3>
                <div class="form-group">
                    <label>Por que deseja adotar?</label>
                    <textarea name="motivo" rows="3" required placeholder="Conte um pouco sobre sua motivação..."></textarea>
                </div>

                <div class="form-group">
                    <label>Possui outros animais? Quais?</label>
                    <textarea name="outros_animais" rows="2" placeholder="Ex: Sim, um gato de 3 anos."></textarea>
                </div>

                <!-- Checkbox -->
                <div class="form-group" style="margin-top: 20px; display: flex; gap: 10px; align-items: center;">
                    <input type="checkbox" id="concorda_check" required style="width: 20px; height: 20px;">
                    <label for="concorda_check" style="margin:0; font-weight:normal;">Estou ciente que a adoção passa por análise e entrevista.</label>
                    <input type="hidden" name="concorda_termos" value="1">
                </div>

                <button type="submit" id="submit-button" class="btn-submit">
                    <i class="fas fa-paper-plane"></i> Enviar Cadastro
                </button>

                <div style="text-align: center; margin-top: 15px;">
                    <a href="adote.html" style="color: #666; font-size: 0.9rem; text-decoration: underline;">Cancelar e Voltar</a>
                </div>
            </form>
        </div>
    </div>

    <footer class="rodape">
        <img src="imagens/logo-extensa.png" alt="Logo">
        <p>Av. José Estima Filho - Jardim Ângela</p>
    </footer>

    <script src="main.js"></script>
    <script>
        // Script para pegar o nome do animal da URL (caso venha da página Adote)
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const animal = urlParams.get('animal');
            if(animal) {
                document.getElementById('animal_desejado').value = decodeURIComponent(animal);
            } else {
                document.getElementById('animal_desejado').value = "Nenhum selecionado (Preencha manualmente ou volte)";
                document.getElementById('animal_desejado').classList.remove('input-readonly');
                document.getElementById('animal_desejado').removeAttribute('readonly');
            }
        };

        // Envio do Form
        document.getElementById('form-adocao').addEventListener('submit', async function(e) {
            e.preventDefault();
            const btn = document.getElementById('submit-button');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';
            btn.disabled = true;

            const formData = new FormData(this);
            try {
                const req = await fetch('api/cadastros/criar_cadastro.php', { method:'POST', body:formData });
                const res = await req.json();
                if(res.success) {
                    alert('Cadastro enviado com sucesso!');
                    window.location.href = 'inicio.html';
                } else {
                    alert('Erro: ' + res.error);
                }
            } catch(err) {
                alert('Erro de conexão (Backend offline?)');
            } finally {
                btn.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Cadastro';
                btn.disabled = false;
            }
        });
        
        document.getElementById('menu-toggle').onclick = () => document.getElementById('nav-list').classList.toggle('active');
    </script>
</body>
</html>